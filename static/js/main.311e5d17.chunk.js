(this["webpackJsonpparametric-svg-editor-react"]=this["webpackJsonpparametric-svg-editor-react"]||[]).push([[0],{26:function(e,t,a){e.exports=a(41)},31:function(e,t,a){},32:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(17),l=a.n(c),i=(a(31),a(11)),u=a(7),s=a(4),m=(a(32),function(e){var t=e.params,a=e.updateParameter;e.defaultParams,e.tree;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,"Parameters"),Object.keys(t).map((function(e){return n.a.createElement("li",{key:"li-".concat(e)},n.a.createElement("label",{htmlFor:"input-".concat(e),key:"label-".concat(e)},e),":",n.a.createElement("input",{id:"input-".concat(e),defaultValue:t[e],key:"param-".concat(e),onChange:function(t){return a(e,t.target.value)}}))})))}),o=a(9),p=a(10),d=function e(t){var a=t.tree,r=t.updateTree,c=t.i,l=t.deleteFunc,i=function(e,t){var n=JSON.parse(JSON.stringify(a));n.children[t]=e,r(n)};return n.a.createElement(n.a.Fragment,null,n.a.createElement("li",null,a.tagName," ",n.a.createElement("button",{onClick:l},n.a.createElement(o.a,{icon:p.b})),n.a.createElement("ul",null,a.attributes.map((function(e){var t=a.attributes.map((function(e){return e.name})).includes("parametric:".concat(e.name));return n.a.createElement("li",null,n.a.createElement("label",{htmlFor:"input-".concat(e.name),key:"label-".concat(e.name)},e.name),":",n.a.createElement("input",{id:"input-".concat(e.name),disabled:t,value:e.value,key:"param-".concat(e.name),onChange:function(t){return function(e,t){var n=a.attributes.map((function(a){return{name:a.name,value:a.name===e?t:a.value}}));r(Object(u.a)({},a,{attributes:n}),c)}(e.name,t.target.value)}}),n.a.createElement("button",{onClick:function(){return t=e.name,a.attributes=a.attributes.filter((function(e){return e.name!==t})),void r(a);var t}},n.a.createElement(o.a,{icon:p.b})))})),n.a.createElement("button",{onClick:function(){var e=prompt("Attribute name","fill");e&&(a.attributes.push({name:e,value:""}),r(a))}},n.a.createElement(o.a,{icon:p.a}))),n.a.createElement("ul",null,a.children.map((function(t,c){return n.a.createElement(e,{tree:t,updateTree:i,i:c,deleteFunc:function(){return function(e){a.children.splice(e,1),r(a)}(c)}})})))))},f=function(e){var t=e.tree,a=e.updateTree;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,"Elements"),n.a.createElement(d,{tree:t,updateTree:a,i:0}),n.a.createElement("button",{onClick:function(){var e=prompt("Tag name","rect");e&&(t.children.push({tagName:e,id:"",className:{},attributes:[],children:[]}),a(t))}},n.a.createElement(o.a,{icon:p.a})))},v=a(42),g=/\{(.+?)\}/g,h=function e(t){var a=t.tree,r=t.params,c=t.defaultParams,l={},i=a.attributes.map((function(e){return e.name}));for(var u in a.attributes){var s=a.attributes[u].name,m=a.attributes[u].value;s&&s.startsWith("parametric:")?(l[s]=m,m=m.replace(g,(function(e,t,a){try{return v.a(t,r)}catch(n){return null}})),l[s.replace("parametric:","")]=m):i.includes("parametric:"+s)||(l[s]=m)}var o=a.children.map((function(t){return n.a.createElement(e,{tree:t,params:r,defaultParams:c})}));return n.a.createElement(a.tagName,l,o)},b=function(e){var t=e.params,a=e.defaultParams,c=e.tree,l=e.updateSVGString;return Object(r.useEffect)((function(){return l()})),n.a.createElement(h,{tree:c,params:t,defaultParams:a})},E=a(23),y=a(20),k=a(21),O=function(){function e(t){Object(y.a)(this,e);var a=document.createElement("div"),r=document.createElement("svg");if(r.id="VIRTUAL-SVG",a.appendChild(r),t.includes("<svg")?r.outerHTML=t:r.innerHTML=t,!(r=a.lastChild))return console.log("Skipping update because of error"),void(this.error=!0);console.log("This is fine"),this.svg=r,this.parameters={},this.defaultParameters={};for(var n=r.childNodes,c=0;c<n.length;c++)this.getParameters(n[c].attributes);this.getDefaultParamValues(),this.tree=this.getTree(this.svg)}return Object(k.a)(e,[{key:"getTree",value:function(e){var t=this,a=[].slice.call(e.children).map((function(e){return t.getTree(e)}));return{tagName:e.tagName,id:e.id,className:e.className,attributes:Object(E.a)(e.attributes).map((function(e){return{name:e.name,value:e.value}})),children:a}}},{key:"getParameters",value:function(e){var t=this;if(e)for(var a=/\{(.+?)\}/g,r=0;r<e.length;r++){var n=e[r];n.name.startsWith("parametric:")&&n.nodeValue.replace(a,(function(e,a,r){t.processExpressionTerm(a)}))}}},{key:"processExpressionTerm",value:function(e){var t=e.replace(/\{/g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/\}/g,"").replace(/\+/g," ").replace(/\-/g," ").replace(/\^/g," ").replace(/\//g," ").replace(/\*/g," ").replace(/,/g," ").replace(/'/g," ").split(" ");for(var a in t)t[a]&&isNaN(t[a])&&(this.parameters[t[a]]||(this.parameters[t[a]]=0))}},{key:"applyParameters",value:function(e){e=e||this.parameters;var t=["rect","circle","ellipse","line","polyline","polygon","text","tspan","tref","textPath","altGlyph","altGlyphDef","altGlyphItem","glyphRef","marker","path"],a=/\{(.+?)\}/g;for(var r in t){var n=this.svg.getElementsByTagName(t[r]);for(var c in n){var l=n[c];for(var i in l.attributes){var u=l.attributes[i].name,s=l.attributes[i].nodeValue;u&&u.startsWith("parametric:")&&(u=u.substr(11),s=s.replace(a,(function(t,a,r){return v.a(a,e)})),l.setAttribute(u,s))}}}}},{key:"getDefaultParamValues",value:function(){var e=this.svg.attributes["parametric:defaults"];if(e){var t,a,r=e.nodeValue.split(";");for(var n in r){var c=r[n].split("="),l=Object(s.a)(c,2);t=l[0],a=l[1],t=t.trim(),this.defaultParameters[t]=a}}return this.defaultParameters}}]),e}(),N=a(22);a(38),a(39),a(40);var j=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(r.useState)(null),o=Object(s.a)(l,2),p=o[0],d=o[1],v=Object(r.useState)(null),g=Object(s.a)(v,2),h=g[0],E=g[1],y=Object(r.useState)('<svg  version="1.1"\n        xmlns="http://www.w3.org/2000/svg"\n        xmlns:parametric="https://parametric-svg.github.io/v0.2"\n        width="500"\n        height="500"\n        parametric:defaults="x=60;y=60;d=5">\n<circle parametric:cx="{x + d}" parametric:cy="{y}" r="40" stroke="black" stroke-width="3" fill="blue" />\n<circle parametric:cx="{x}" parametric:cy="{y}" r="40" stroke="black" stroke-width="3" fill="green" />\n</svg>'),k=Object(s.a)(y,2),j=k[0],P=k[1],T=Object(r.useState)(null),w=Object(s.a)(T,2),S=w[0],x=w[1],V=function(e){var t=new O(e);t.error||(c(Object(u.a)({},t.params,{},t.defaultParameters)),d(t.defaultParameters),E(t.tree))};a||V(j);var C={lineNumberFormatter:function(e){return""},lineNumbers:!0,lineWrapping:!0,value:j,theme:"dracula"};return n.a.createElement("div",null,n.a.createElement("div",{className:"page-header"},n.a.createElement("h1",null,"Parametric SVG editor"),n.a.createElement("p",{className:"lead"},"An editor for SVG images in which attributes can contain parameters.")),n.a.createElement("div",{className:"parent"},n.a.createElement("div",{className:"div1",id:"code-panel"},n.a.createElement("div",{id:"parameters"},n.a.createElement(m,{params:a,defaultParams:p,updateParameter:function(e,t){var r=Object(u.a)({},a,Object(i.a)({},e,t));c(r);var n=Object.keys(r).map((function(e){return"".concat(e,"=").concat(r[e])})).join(";"),l=h.attributes.map((function(e){return{name:e.name,value:"parametric:defaults"===e.name?n:e.value}})),s=Object(u.a)({},h,{attributes:l});E(s)}})),n.a.createElement("div",{id:"elements"},n.a.createElement(f,{tree:h,params:a,defaultParams:p,updateTree:function(e){E(JSON.parse(JSON.stringify(e)))}}))),n.a.createElement("div",{className:"div2",id:"svg-panel"},n.a.createElement(b,{tree:h,params:a,defaultParams:p,updateSVGString:function(){var e=document.getElementById("svg-panel").getElementsByTagName("svg")[0].outerHTML;e!==j&&(P(e),V(e))}}))),n.a.createElement(N.UnControlled,{value:j,onBlur:function(){return null},options:C,onChange:function(e,t,a){x(a)}}),n.a.createElement("button",{onClick:function(e){V(S)}}," Update!"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.311e5d17.chunk.js.map